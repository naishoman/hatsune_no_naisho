            ＜＜＜　初音ミクのロボ声　Ver 0.17　＞＞＞

・目的
　Vocaloid(2)のVSTiと形態素解析エンジンMeCabを使って、任意の文章をロボ声でしゃべらせる実験プログラムです。
　引数で文章を指定できるEXEと、SAPI5 TTSエンジンの2種類があります。

・動作に必要なもの
　・mecab-win32
    http://mecab.sourceforge.net/ から、mecab-0.98.exeをインストールしてください。
    バージョンが上がっていた場合には、最新版を入れてください。(2010/7/10現在 最新版 0.98)
    MeCabのDLL(libmecab.dll)へのパスを通してください。
    パスを通すとは、
    １、環境変数PATHにlibmecab.dllの場所を追加する（正攻法）
    ２、libmecab.dllを本ツールの場所にコピーする（簡単）
    ３、libmecab.dllをWindow\System32などにコピーする（邪道）
    などなど・・・です。
　・Vocaloid(2) VSTi
    Vocaloid2およびVocaloid1のインストール時に、VSTiのインストールを行ってください。
　・ユーザー辞書
    英語版ボカロに喋らせるために必要です。日本人ボカロには不要です。
    ボーカフォネティック　http://vocaphonetic.web.fc2.com/

・インストール方法
　解凍したものをすべて任意のフォルダーにまとめて置いてください。
　SAPI5用のTTSエンジンをインストールする場合には、
　setup.exeを実行し、しゃべらせるボカロのTTSエンジンを登録してください。

・セットアップ
　SAPI5用のTTSエンジンを使用するためには、TTS音声をセットアップする必要があります。
　setup.exeを実行してください。(Ver.0.15以降はinstall.batは不要になりました。)
　追加ボタンを押して、歌手を選択、名称を入力してOKを押せば、TTS音声を追加できます。
　名称には、他のTTSエンジンで使用している文字列は指定しないでください。
　ベースキーは、男性ボカロに喋らせる場合など基本音程を変化させたい場合に変更してください。
　ユーザー辞書は、英語版ボカロに日本語を喋らせる場合には必須です。
　詳細は、ユーザー辞書の項目を参照ください。
　TTSエンジンをインストール後に、フォルダを移動させないでください。

・アンインストール方法
　SAPI用のTTSエンジンのインストールを行なっていない場合には、そのまま削除してください。
　SAPI用のTTSエンジンをアンインストールする場合には、
　setup.exeにて、TTS音声を全て削除ししてください。

・使用方法
　１）動作テスト兼TTSエンジンのホスト(muku_speak.exe)
　　コマンドプロンプトを開いて、muku_speak.exeの後に、任意の文章を引数で渡してください。
　　サンプルのバッチファイル(test.bat)は、そのままダブルクリックで動きます。（たぶん・・・）
　　この方法では、ボーカロイドのプログラム番号0番の声が使用されます。
　　プログラム番号は、SingerEditorのPCの値を確認ください。
　　引数なしで呼び出した場合には、TTSエンジンのホストとして常駐します。
　　（DLL側から自動起動されるので、通常は手動で起動する必要はありません。）
　２）SAPI5 TTSのDLL(vocaloidtts.dll)
　　SAPIの音声合成アプリで確認ください。標準状態では、プログラム番号0のVocaloidが喋ります。
　　本DLLから、TTSエンジンのホスト(miku_speak.exe)を必要に応じて起動します。
　　EXEは、使用するDLLがなくなってしばらくすると自然終了するはず・・・
　　JScriptから呼び出すサンプル(SimpleTTS.js)が入っています。
　　MikuというTTS音声を追加したときは、そのままダブルクリックで動きます。

・ユーザー辞書（英語版ボカロに喋らせるには必須です）
　登録する辞書は、miku_speak.exeと同じ場所に置いてください。
　辞書の形式は、「文字」と「発音記号」をタブ区切りにしたものです。
　また、先頭が/で始まるものは、コメント行として無視します。
　エラーチェックはイイカゲンなので、変なフォーマットのものを読み込ませないでください。
　日本人ボカロでも発音をカスタマイズすることは可能です。

・レジストリについて
　本ツールは、TTSエンジンであるCOMの登録および、TTSエンジンの登録にレジストリを使用します。
　TTSエンジンの登録は、HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Speech\Voices\Tokens以下に
　任意のTTS音声キーを作成、その下に以下の設定項目を書き込みます。
　BaseKey       ベースキー（デフォルトは、64）
　ProgramNumber  0-7bit:    ボーカロイドのPC
　               8-15bit:   0:Vocaloid2エンジン 1:Vocaloid1エンジン
　              16-23bit:   ボーカロイドのBS(0:日本語エンジン 1:英語エンジン)
　UDIC          ひらがなを発音記号に変更するときに使用する辞書。
　              指定がない場合には、内蔵の変換辞書を使用します。
　本設定は、TTS音声セットアッププログラム(setup.exe)から設定されますので、
　通常は、変更する必要はありません。

・その他
　test.batとSimpleTTS.jsは、動作確認用サンプルなので削除して構いません。
　インストール後に最低限必要なファイルは、miku_speak.exeとvocaloidtts.dllです。
　MeCabのバイナリーパッケージには辞書も含むので問題ないと思うですが、
　他の方法でインストールされた方は、辞書を正しく作成および設定を行って、
　MeCabが正しく動く状態で確認ください。
　Vocaloid2のVSTiは、インストール時に指定した場所に置いてください。
　インストール後、ファイルを移動させると動きません。
　(デフォルトは、*:\Program Files\Steinberg\VSTplugins\VOCALOID2かな？)
　EXEとDLLの連携不足で、EXEプロセスが残ったままになったり、DLLとの通信が不能になるケースがあると思います・・・。
　そうなった場合には、EXEを手動で終了させた後、TTSアプリの再起動を行ってみてください。
　Ver.1.00を目標に安定したものを作りたいなぁ・・・

・無保証/自己責任
　まだバグが一杯あると思います。とくにエラーチェックなどがいい加減です・・・
　本プラグラム使用者に損害を与えるような作りにはなっていないと思いますが、
　何か問題が発生した場合でも自己責任でお願いいたします。

・更新履歴
  Ver.0.17  ・リップシンクもどき実装。(正確な実装ではなく音声の大小によって口パクするだけです。)
  Ver.0.16  ・「じゃ」「じぃ」「じゅ」「じぇ」「じょ」が発音しないのを修正。
            ・細かな修正などなど。
  Ver.0.15  ・TTSエンジンのインストール/アンインストールの機能をsetup.exeに統合。
            ・VSTiやVocaloidEditorなどとの同時起動制限を解除
  Ver.0.14  ・0.13でカタカナ語などの未定義語を喋らなくなったのを修正
  Ver.0.13  ・MeCabから読み取得の方法を正しく修正
  Ver.0.12  ・ポカミス修正 orz
  Ver.0.11  ・0.10でVocaloid1のNRPNがエンバグしてたのを修正
            ・miku_speak常駐時に、Vocaloid1/2エンジンを切り替えられない不具合を修正
            ・VSTiの開放方法を修正
  Ver.0.10  ・TTS音声セットアッププログラム(setup.exe)を追加
            ・デフォルトのTTSトークンを登録しないようにした。(Vocaloid)
  Ver.0.09  ・英語版ボカロに対応したつもり（Bank切り替え対応）
            ・外部ユーザー発音辞書に対応（英語版ボカロに発音させるには、ボーカフォネティックの辞書が必要です。）
  Ver.0.08  ・BaseKeyの設定項目を追加
  Ver.0.07  ・Vocaloid1エンジンにも対応してみた。
            ・発声の長さ計算がバグってたので、修正した。（以前のバージョンと標準の速度が変わりました。）
  Ver.0.06  ・0.05によって、ミク/リン/レン使い分けが使い物にならなくなってたのを修正。
  Ver.0.05  ・vocaloidtts.dllからmiku_speak.exeを呼び出すように変更(プロセス分離)
  Ver.0.04  ・再生位置を正しく処理するように修正。(SAPI DLL)
            ・文単位できちんと分けるように修正。(SAPI DLL)
            ・出だしのディレイを無くした。(SAPI DLL)
  Ver.0.03  ・フリーズの不具合修正(SAPI DLL)
  Ver.0.02  ・再生速度、音量調節に対応。(SAPI DLL)
            ・メモリーリーク個所を修正
  Ver.0.01  ・TTSエンジン(vocaloidtts.dll)を作成。
            ・miku_speak.exeの終了処理を改善。
  Ver.0.00  ・とりあえず作った。

・謝辞
　「また今日も徹夜してしまった」峪えいじ氏が、MusicMakerやTVMLと組み合わせて面白い動画を公開されています。活用？していただき有難うございます。
　「人生は是勉学の事」Akira-Izumi氏のPerlスクリプトを参考にさせていただきました。どうもありがとうございます。
　オープンソース形態素解析エンジン MeCabの開発者に感謝いたします。
　英語版ボカロで日本語を話すために、ボーカフォネティックの辞書を使用させていただきました。どうもありがとうございます。
