MMDAgent用Scriptプラグイン

・目的
　MMDAgentに外部スクリプトを読み込ませることで、シナリオファイル単独では不可能な
　動的なアクションを可能にします。また、スクリプトによるコマンドの拡張を行えます。

・動作に必要なもの
　・MMDAgent
　　当然必要です！sourceforgeまたは、名工大のHPからダウンロードしてください。
　　2011/03/03公開のRC版と2011/2/3公開のBeta版で動作確認済みです。
　　なお、プラグインの仕様が変更された場合には、動作しなくなる可能性が大です。

・インストール方法
　MMDAgentのフォルダに、PluginsフォルダにPlugin_Script.dllを入れてください。
　外部スクリプトファイルは、AppData\Scriptに置いてください。
　なお、本プラグインは、MMDAgentの機能を拡張するものであるため、導入するだけでは、何もできません。
　スクリプトの作成や、シナリオファイルへの修正は各自行う必要があります。
　また、本プラグインで使用するスクリプトファイルは、MMDAgentから読み込ませることで動作を拡張するもので、
　スクリプトをダブルクリックなどでMMDAgentを操作するものではありません。

・拡張コマンド仕様
　以下のコマンドを拡張します。また、スクリプトによって任意のコマンドの拡張が可能です。

　1)LOAD_SCRIPT|スクリプトファイル
　　スクリプトファイルを読み込みます。読み込み可能なスクリプトは、JScript(*.js)とVBScript(*.vbs)です。
　　現在複数スクリプトファイルの読み込みは対応していません。

　2)EXEC_METHOD|関数名[|...|...]
　　スクリプトファイル中の関数を呼び出します。関数名の後には任意の数の引数が渡せます。
　　現在メインスレッドで実行されるため、スクリプト実行中は、描画などが停止します。

・スクリプト仕様
　現在対応するスクリプトは、JScriptとVBScriptです。

　公開オブジェクト
　・mmdagent
　　MMDAgentへの操作を行います。以下のメソッドとプロパティを持ちます。

　　○メソッド
　　　1)postCommand(コメンド名,引数[,...])
　　　　コマンドメッセージを発行します。
　　　2)postEvent(イベント名,引数[,...])
　　　　イベントを発行します。
　　　3)sleep(時間)
　　　　指定された時間[ms]だけスリープします。
　　　　（現在メインスレッドで動作するため呼び出す意味はない。）
　　　4)msgBox(文字列)
　　　　メッセージボックスを表示します。デバッグ用には使えるかも
　　　5)dbgMsg(文字列)
　　　　OutputDebugStringで出力します。分かる人はどうぞ・・・（デバッグ用）

　　○プロパティ
　　　1)onCommand
　　　　コマンドを受信したら呼び出されるハンドラを登録します。
　　　　スクリプトでコマンド処理を拡張できます。
　　　2)onEvent
　　　　イベントを受信したら呼び出されるハンドラを登録します。
　　　　スクリプトでイベント処理を拡張できます。

・サンプル
　サンプルを実行するためには、シナリオファイル(*.fst)にLOAD_SCRIPTなどのコマンドを記述する必要があります。
　1)アプリケーション起動(exec.js/exec.vbs)
　　イベントの受信のサンプルです。
　2)SAPI(sapi.js/sapi.vbs)
　　SAPIプラグインの簡易版です。リップシンクなどは行いません。
　　コマンドの受信のサンプルとActiveX呼び出しのサンプルです。
　3)時報もどき(clock.js/clock.vbs)
　　およそ１時間ごとに現在時刻を読み上げます。
　　コメンドメッセージを投げるサンプルです。
　4)オウム返し(echo.js/echo.vbs)
　　認識した言葉をそのまま喋ります。
　　イベントの受信とコメンドメッセージを投げるサンプルです。
　4)オウム返し(func.js/func.vbs)
　　関数呼び出しのサンプルです。

・制限事項
　よく落ちるのは、たぶんMMDAgent本体側の問題じゃないかと思っていますが・・・（ヒープ壊してそうだし^^;;）
　MMDAgent本体のデバッグはしていないので（汗）
　スクリプトの仕様などは、今後のバージョンアップにより変更される可能性があります。
　とりあえずバイナリのみですが、デバッグ＆ソースの整理をして気が向いたら
　ソースも公開するかも？

・更新予定？
　他スクリプトへの対応（拡張子とスクリプトエンジンの関連付けってどうなってるんだろう・・・）
　（ActiveScriptに対応しているものではれば、すぐに組み込み可能です。）
　スクリプトの実行を非ブロックにする？

・更新履歴
  Ver.0.02  ・MMDAgent RC版に対応。ヘルパー関数群更新。
  Ver.0.01  ・MMDAgent beta版に対応した。
  Ver.0.00  ・とりあえず作った。
